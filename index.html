<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ListIt Pro ‚Äî Vehicle Listing Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=Manrope:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #08090c;
    --surface: #0f1117;
    --surface2: #161820;
    --surface3: #1c1f2a;
    --border: rgba(255,255,255,0.07);
    --border-hover: rgba(255,255,255,0.14);
    --accent: #6c63ff;
    --accent2: #9d97ff;
    --accent-glow: rgba(108,99,255,0.25);
    --amber: #f59e0b;
    --amber-glow: rgba(245,158,11,0.2);
    --text: #f0f2f8;
    --text-secondary: #8891a8;
    --green: #10d48e;
    --red: #f04343;
    --green-glow: rgba(16,212,142,0.2);
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Manrope', sans-serif;
    min-height: 100vh;
    background-image:
      radial-gradient(ellipse 80% 50% at 10% 0%, rgba(108,99,255,0.08) 0%, transparent 60%),
      radial-gradient(ellipse 60% 40% at 90% 100%, rgba(245,158,11,0.05) 0%, transparent 60%);
  }

  /* ‚îÄ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ */
  header {
    background: rgba(8,9,12,0.8);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    padding: 0 32px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 60px;
    position: sticky;
    top: 0;
    z-index: 100;
  }
  .header-left { display: flex; align-items: center; gap: 14px; }
  .logo-mark {
    width: 34px; height: 34px;
    background: var(--accent);
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-family: 'Syne', sans-serif;
    font-weight: 800;
    font-size: 0.85rem;
    color: #fff;
    letter-spacing: -0.5px;
    box-shadow: 0 0 20px var(--accent-glow);
    flex-shrink: 0;
  }
  .logo {
    font-family: 'Syne', sans-serif;
    font-size: 1.15rem;
    font-weight: 700;
    color: var(--text);
    letter-spacing: -0.3px;
  }
  .logo span { color: var(--accent); }
  .tagline {
    font-size: 0.72rem;
    color: var(--text-secondary);
    font-weight: 400;
    letter-spacing: 0.3px;
  }
  .header-badge {
    background: rgba(108,99,255,0.12);
    border: 1px solid rgba(108,99,255,0.3);
    color: var(--accent2);
    font-size: 0.68rem;
    font-weight: 600;
    padding: 4px 10px;
    border-radius: 20px;
    letter-spacing: 0.5px;
    text-transform: uppercase;
  }

  /* ‚îÄ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ‚îÄ */
  .main { display: grid; grid-template-columns: 400px 1fr; gap: 0; min-height: calc(100vh - 60px); }

  .panel {
    padding: 24px 20px;
    border-right: 1px solid var(--border);
    overflow-y: auto;
    max-height: calc(100vh - 60px);
  }
  .output-panel { padding: 24px 20px; overflow-y: auto; max-height: calc(100vh - 60px); }

  /* ‚îÄ‚îÄ‚îÄ SECTION TITLE ‚îÄ‚îÄ‚îÄ */
  .section-title {
    font-family: 'Syne', sans-serif;
    font-size: 0.7rem;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .section-title .sticon {
    width: 22px; height: 22px;
    border-radius: 6px;
    background: var(--surface3);
    border: 1px solid var(--border);
    display: flex; align-items: center; justify-content: center;
    font-size: 0.65rem;
  }
  .section-title::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--border);
  }

  /* ‚îÄ‚îÄ‚îÄ FIELDS ‚îÄ‚îÄ‚îÄ */
  .field { margin-bottom: 12px; }
  .field label {
    display: block;
    font-size: 0.72rem;
    font-weight: 600;
    color: var(--text-secondary);
    letter-spacing: 0.5px;
    margin-bottom: 5px;
  }
  select, input {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 10px 14px;
    border-radius: 10px;
    font-family: 'Manrope', sans-serif;
    font-size: 0.875rem;
    font-weight: 500;
    appearance: none;
    transition: border-color 0.2s, background 0.2s, box-shadow 0.2s;
  }
  select:hover, input:hover { border-color: var(--border-hover); }
  select:focus, input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px var(--accent-glow);
    background: var(--surface3);
  }
  select { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath fill='%238891a8' d='M5 6L0 0h10z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 13px center; padding-right: 36px; }
  select:disabled, input:disabled { opacity: 0.35; cursor: not-allowed; }

  .grid2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

  /* ‚îÄ‚îÄ‚îÄ BUTTONS ‚îÄ‚îÄ‚îÄ */
  .btn {
    width: 100%;
    padding: 11px 18px;
    border-radius: 10px;
    border: none;
    font-family: 'Manrope', sans-serif;
    font-weight: 700;
    font-size: 0.875rem;
    cursor: pointer;
    transition: all 0.18s;
    letter-spacing: 0.2px;
    display: inline-flex; align-items: center; justify-content: center; gap: 7px;
  }
  .btn-primary {
    background: var(--accent);
    color: #fff;
    box-shadow: 0 4px 20px var(--accent-glow);
  }
  .btn-primary:hover { background: var(--accent2); transform: translateY(-1px); box-shadow: 0 6px 24px rgba(108,99,255,0.4); }
  .btn-primary:active { transform: translateY(0); }
  .btn-primary:disabled { background: var(--surface3); color: var(--text-secondary); cursor: not-allowed; transform: none; box-shadow: none; border: 1px solid var(--border); }

  .btn-ghost {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text-secondary);
    width: auto;
    padding: 9px 16px;
    font-size: 0.8rem;
  }
  .btn-ghost:hover { border-color: var(--border-hover); color: var(--text); background: var(--surface3); }

  .btn-success {
    background: rgba(16,212,142,0.12);
    border: 1px solid rgba(16,212,142,0.3);
    color: var(--green);
    width: auto;
    padding: 10px 20px;
    box-shadow: 0 0 20px var(--green-glow);
  }
  .btn-success:hover { background: rgba(16,212,142,0.2); border-color: var(--green); }

  .btn-generate {
    background: linear-gradient(135deg, var(--accent) 0%, #8b5cf6 100%);
    color: #fff;
    box-shadow: 0 4px 24px var(--accent-glow);
    font-size: 0.9rem;
    padding: 13px;
  }
  .btn-generate:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(108,99,255,0.45); }

  /* ‚îÄ‚îÄ‚îÄ VIN CARD ‚îÄ‚îÄ‚îÄ */
  .vin-card {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 14px;
    margin-bottom: 20px;
    position: relative;
    overflow: hidden;
  }
  .vin-card::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(108,99,255,0.05) 0%, transparent 60%);
    pointer-events: none;
  }

  /* ‚îÄ‚îÄ‚îÄ FEATURES ‚îÄ‚îÄ‚îÄ */
  .features-box {
    border-radius: 12px;
    padding: 2px;
    margin-top: 8px;
    max-height: 230px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }
  .feature-item {
    display: flex;
    align-items: center;
    padding: 8px 12px;
    border-radius: 9px;
    cursor: pointer;
    transition: all 0.15s ease;
    background: rgba(108,99,255,0.08);
    border: 1px solid rgba(108,99,255,0.2);
    user-select: none;
    position: relative;
  }
  .feature-item::before {
    content: '‚úì';
    width: 18px; height: 18px;
    border-radius: 5px;
    background: rgba(108,99,255,0.25);
    color: var(--accent2);
    font-size: 0.7rem;
    font-weight: 700;
    display: flex; align-items: center; justify-content: center;
    margin-right: 9px;
    flex-shrink: 0;
  }
  .feature-item span {
    font-size: 0.84rem;
    color: var(--text);
    font-weight: 500;
    line-height: 1.4;
  }
  .feature-item.inactive {
    background: rgba(255,255,255,0.02);
    border-color: var(--border);
    opacity: 0.4;
  }
  .feature-item.inactive::before {
    content: '';
    background: var(--surface3);
  }
  .feature-item.inactive span { color: var(--text-secondary); }
  .feature-item:hover { filter: brightness(1.15); }

  /* ‚îÄ‚îÄ‚îÄ OUTPUT TEXTAREA ‚îÄ‚îÄ‚îÄ */
  .output-textarea {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 12px;
    color: var(--text);
    font-family: 'Manrope', sans-serif;
    font-size: 0.875rem;
    line-height: 1.75;
    padding: 18px;
    resize: vertical;
    min-height: 460px;
    transition: border-color 0.2s, box-shadow 0.2s;
  }
  .output-textarea:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px var(--accent-glow);
  }
  .output-textarea::placeholder { color: var(--text-secondary); opacity: 0.6; }

  /* ‚îÄ‚îÄ‚îÄ TEMPLATE GRID ‚îÄ‚îÄ‚îÄ */
  .template-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 6px;
    margin-bottom: 16px;
  }
  .template-btn {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text-secondary);
    padding: 9px 10px;
    border-radius: 9px;
    font-size: 0.75rem;
    font-weight: 600;
    cursor: pointer;
    text-align: center;
    transition: all 0.18s;
    font-family: 'Manrope', sans-serif;
    letter-spacing: 0.2px;
  }
  .template-btn:hover { border-color: var(--border-hover); color: var(--text); background: var(--surface3); }
  .template-btn.active {
    border-color: var(--accent);
    color: var(--accent2);
    background: rgba(108,99,255,0.1);
    box-shadow: 0 0 12px var(--accent-glow);
  }

  /* ‚îÄ‚îÄ‚îÄ STATUS ‚îÄ‚îÄ‚îÄ */
  .status {
    display: inline-flex;
    align-items: center;
    gap: 7px;
    font-size: 0.78rem;
    font-weight: 500;
    padding: 6px 12px;
    border-radius: 20px;
    margin-bottom: 10px;
  }
  .status.loading { background: rgba(245,158,11,0.1); color: var(--amber); border: 1px solid rgba(245,158,11,0.25); }
  .status.done { background: rgba(16,212,142,0.1); color: var(--green); border: 1px solid rgba(16,212,142,0.25); }
  .status.error { background: rgba(240,67,67,0.1); color: var(--red); border: 1px solid rgba(240,67,67,0.25); }
  .dot { width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0; }
  .dot.pulse { background: var(--amber); animation: pulse 1s infinite; }
  @keyframes pulse { 0%,100% { opacity:1; } 50% { opacity:0.3; } }
  .dot.green { background: var(--green); }
  .dot.red { background: var(--red); }

  /* ‚îÄ‚îÄ‚îÄ ACTION ROW ‚îÄ‚îÄ‚îÄ */
  .action-row { display: flex; gap: 8px; align-items: center; margin-top: 12px; flex-wrap: wrap; }

  /* ‚îÄ‚îÄ‚îÄ DIVIDER ‚îÄ‚îÄ‚îÄ */
  .divider { height: 1px; background: var(--border); margin: 18px 0; }

  /* ‚îÄ‚îÄ‚îÄ INFO PILL ‚îÄ‚îÄ‚îÄ */
  .info-pill {
    background: rgba(108,99,255,0.08);
    border: 1px solid rgba(108,99,255,0.2);
    color: var(--accent2);
    font-size: 0.7rem;
    font-weight: 600;
    padding: 4px 10px;
    border-radius: 20px;
    margin-bottom: 12px;
    display: inline-block;
    letter-spacing: 0.3px;
  }

  /* ‚îÄ‚îÄ‚îÄ CUSTOM SECTION ‚îÄ‚îÄ‚îÄ */
  .custom-section { margin-top: 12px; }
  .custom-section textarea {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 12px 14px;
    border-radius: 10px;
    font-family: 'Manrope', sans-serif;
    font-size: 0.84rem;
    line-height: 1.6;
    resize: vertical;
    min-height: 80px;
    transition: border-color 0.2s, box-shadow 0.2s;
  }
  .custom-section textarea:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px var(--accent-glow); }

  .char-hint { font-size: 0.7rem; color: var(--text-secondary); margin-top: 4px; }

  /* ‚îÄ‚îÄ‚îÄ CUSTOM TEMPLATE EDITOR ‚îÄ‚îÄ‚îÄ */
  #customTemplate {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 14px;
    border-radius: 12px;
    font-family: 'Manrope', sans-serif;
    font-size: 0.84rem;
    line-height: 1.65;
    resize: vertical;
    min-height: 200px;
    transition: border-color 0.2s, box-shadow 0.2s;
  }
  #customTemplate:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px var(--accent-glow); }

  /* ‚îÄ‚îÄ‚îÄ SCROLLBAR ‚îÄ‚îÄ‚îÄ */
  ::-webkit-scrollbar { width: 5px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 3px; }
  ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.14); }

  /* ‚îÄ‚îÄ‚îÄ MOBILE TAB BAR ‚îÄ‚îÄ‚îÄ */
  .mob-tabs {
    display: none;
    position: fixed;
    bottom: 0; left: 0; right: 0;
    z-index: 200;
    background: rgba(15,17,23,0.95);
    backdrop-filter: blur(20px);
    border-top: 1px solid var(--border);
    grid-template-columns: 1fr 1fr;
  }
  .mob-tab {
    padding: 14px;
    text-align: center;
    font-family: 'Syne', sans-serif;
    font-size: 0.8rem;
    font-weight: 700;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s;
    border: none;
    background: none;
    width: 100%;
  }
  .mob-tab.active { color: var(--accent2); }

  @media (max-width: 768px) {
    header { padding: 0 16px; height: 54px; }
    .logo { font-size: 1rem; }
    .tagline { display: none; }
    .header-badge { display: none; }

    .main { display: block; min-height: unset; }
    .panel {
      display: none; border-right: none;
      max-height: unset; overflow-y: unset;
      padding: 16px 14px 100px;
    }
    .panel.mob-active { display: block; }
    .output-panel {
      display: none; max-height: unset; overflow-y: unset;
      padding: 16px 14px 100px;
    }
    .output-panel.mob-active { display: block; }
    .mob-tabs { display: grid; }
    .grid2 { grid-template-columns: 1fr; }
    .output-textarea { min-height: 340px; font-size: 0.85rem; }
    .action-row { flex-wrap: wrap; }
    .action-row .btn-generate { width: 100%; }
    .features-box { max-height: 320px; }
    select, input { font-size: 1rem; }
    #customTemplate { min-height: 150px; }
  }
</style>
</head>
<body>

<header>
  <div class="header-left">
    <div class="logo-mark">LP</div>
    <div>
      <div class="logo">List<span>It</span> Pro</div>
      <div class="tagline">Vehicle Listing Generator</div>
    </div>
  </div>
  <div class="header-badge">AI Powered</div>
</header>

<!-- MOBILE TAB BAR -->
<div class="mob-tabs" id="mobTabs">
  <button class="mob-tab active" id="tabInput" onclick="switchTab('input')">‚öôÔ∏è Build</button>
  <button class="mob-tab" id="tabOutput" onclick="switchTab('output')">üìÑ Listing</button>
</div>

<div class="main">
  <!-- LEFT PANEL -->
  <div class="panel mob-active" id="inputPanel">

    <!-- VIN DECODER -->
    <div class="section-title"><span class="sticon">üîç</span> VIN Decoder</div>
    <div class="vin-card">
      <div class="field" style="margin-bottom:0">
        <label>Paste VIN to Auto-Fill</label>
        <div style="display:flex;gap:8px;margin-top:5px;">
          <input type="text" id="vinInput" placeholder="e.g. 1HGCM82633A123456" maxlength="17" style="flex:1;text-transform:uppercase;letter-spacing:1.5px;font-size:0.82rem;">
          <button class="btn btn-primary" style="width:auto;padding:10px 16px;font-size:0.82rem;" onclick="decodeVIN()">Decode</button>
        </div>
        <div id="vinStatus" style="margin-top:7px;font-size:0.75rem;min-height:16px;"></div>
      </div>
    </div>

    <!-- VEHICLE SELECTOR -->
    <div class="section-title"><span class="sticon">üöó</span> Vehicle</div>
    <div class="grid2" style="margin-bottom:12px;">
      <div class="field" style="margin-bottom:0">
        <label>Year</label>
        <select id="yearSelect"><option value="">Year</option></select>
      </div>
      <div class="field" style="margin-bottom:0">
        <label>Make</label>
        <select id="makeSelect"><option value="">Make</option></select>
      </div>
    </div>
    <div class="field">
      <label>Model</label>
      <select id="modelSelect" disabled><option value="">Select Model</option></select>
    </div>
    <div class="field">
      <label>Trim</label>
      <select id="trimSelect" disabled><option value="">Select Trim</option></select>
    </div>

    <div class="divider"></div>

    <!-- MANUAL FIELDS -->
    <div class="section-title"><span class="sticon">üìã</span> Details</div>
    <div class="grid2">
      <div class="field">
        <label>Miles</label>
        <input type="text" id="milesInput" placeholder="68,450">
      </div>
      <div class="field">
        <label>Color</label>
        <input type="text" id="colorInput" placeholder="Midnight Blue">
      </div>
    </div>
    <div class="field">
      <label>Asking Price ($)</label>
      <input type="text" id="priceInput" placeholder="18,995">
    </div>

    <div class="divider"></div>

    <!-- DEALER INFO -->
    <div class="section-title"><span class="sticon">üè¢</span> Dealer Info</div>
    <div class="field">
      <label>Dealer Name</label>
      <input type="text" id="dealerName" placeholder="Metro Auto Sales">
    </div>
    <div class="field">
      <label>Address</label>
      <input type="text" id="dealerAddress" placeholder="9999 Highway 888 NW, City, ST 99999">
    </div>
    <div class="grid2">
      <div class="field">
        <label>Hours</label>
        <input type="text" id="dealerHours" placeholder="Mon‚ÄìSat 10am‚Äì6pm">
      </div>
      <div class="field">
        <label>Website</label>
        <input type="text" id="dealerWebsite" placeholder="YourSite.com">
      </div>
    </div>

    <div class="divider"></div>

    <!-- FETCH FEATURES -->
    <div class="section-title"><span class="sticon">‚ú®</span> Key Features</div>
    <button class="btn btn-primary" id="fetchBtn" disabled onclick="fetchFeatures()">
      üîç Fetch Vehicle Features
    </button>

    <div id="featuresContainer" style="display:none; margin-top:12px;">
      <div id="statusMsg"></div>
      <div class="features-box" id="featuresList"></div>
      <div class="custom-section">
        <label style="display:block;font-size:0.72rem;font-weight:600;color:var(--text-secondary);letter-spacing:0.5px;margin-bottom:6px;">ADD CUSTOM FEATURE</label>
        <div style="display:flex;gap:8px;">
          <input type="text" id="customFeatureInput" placeholder="e.g. Tow Package üöõ" style="flex:1;">
          <button class="btn btn-ghost" onclick="addCustomFeature()">Add</button>
        </div>
      </div>
    </div>

  </div>

  <!-- RIGHT PANEL -->
  <div class="output-panel" id="outputPanel">

    <div class="section-title"><span class="sticon">üìù</span> Listing Template</div>
    <div class="info-pill">Choose a style ‚Äî or write your own below</div>
    <div class="template-grid" id="templateGrid"></div>

    <div class="section-title"><span class="sticon">üìÑ</span> Generated Listing</div>
    <textarea class="output-textarea" id="outputText" placeholder="Select a vehicle, fill in details, fetch features ‚Äî then click Generate Listing‚Ä¶"></textarea>

    <div class="action-row">
      <button class="btn btn-generate" style="flex:1;" onclick="generateListing()">‚ö° Generate Listing</button>
      <button class="btn btn-success" onclick="copyListing()">üìã Copy</button>
      <button class="btn btn-ghost" onclick="clearAll()">üóë</button>
    </div>

    <div class="divider"></div>
    <div class="section-title"><span class="sticon">üé®</span> Custom Template Editor</div>
    <p style="font-size:0.78rem;color:var(--text-secondary);margin-bottom:10px;line-height:1.6;">Use placeholders: <code style="color:var(--accent2);background:rgba(108,99,255,0.1);padding:1px 5px;border-radius:4px;font-size:0.73rem;">{{year}} {{make}} {{model}} {{trim}} {{miles}} {{color}} {{price}} {{engine}} {{drivetrain}} {{transmission}} {{features}} {{address}} {{hours}} {{website}}</code></p>
    <textarea id="customTemplate" placeholder="Write your own template here using the placeholders above‚Ä¶"></textarea>
    <div class="action-row" style="margin-top:10px;">
      <button class="btn btn-ghost" onclick="saveCustomTemplate()">üíæ Save as Preset 10</button>
      <button class="btn btn-ghost" onclick="useCustomTemplate()">‚úÖ Use This Template</button>
    </div>

  </div>
</div>

<script>
// ============================================================
// DATA
// ============================================================
const MAKES_MODELS = {
  "Acura": ["ILX","MDX","RDX","RLX","TL","TLX","TSX","ZDX"],
  "Audi": ["A3","A4","A5","A6","A7","A8","Q3","Q5","Q7","Q8","RS3","RS5","RS7","S4","S5","TT"],
  "BMW": ["2 Series","3 Series","4 Series","5 Series","6 Series","7 Series","8 Series","M3","M4","M5","X1","X2","X3","X4","X5","X6","X7","Z4"],
  "Buick": ["Enclave","Encore","Encore GX","Envision","LaCrosse","Regal","Verano"],
  "Cadillac": ["CT4","CT5","CT6","Escalade","SRX","XT4","XT5","XT6"],
  "Chevrolet": ["Blazer","Camaro","Colorado","Corvette","Equinox","Express","Impala","Malibu","Silverado 1500","Silverado 2500","Silverado 3500","Sonic","Spark","Suburban","Tahoe","Traverse","Trax"],
  "Chrysler": ["200","300","Pacifica","Voyager"],
  "Dodge": ["Challenger","Charger","Dakota","Durango","Grand Caravan","Journey","Ram 1500"],
  "Ford": ["Bronco","Bronco Sport","EcoSport","Edge","Escape","Expedition","Explorer","F-150","F-250","F-350","Flex","Fusion","Maverick","Mustang","Ranger","Transit","Transit Connect"],
  "GMC": ["Acadia","Canyon","Envoy","Sierra 1500","Sierra 2500","Sierra 3500","Terrain","Yukon","Yukon XL"],
  "Honda": ["Accord","CR-V","CR-Z","Civic","Element","Fit","HR-V","Odyssey","Passport","Pilot","Ridgeline"],
  "Hyundai": ["Accent","Elantra","Genesis","Ioniq","Kona","Palisade","Santa Cruz","Santa Fe","Sonata","Tucson","Venue","Veloster"],
  "Infiniti": ["EX","FX","G","JX","M","Q50","Q60","Q70","QX30","QX50","QX55","QX60","QX80"],
  "Jeep": ["Cherokee","Commander","Compass","Gladiator","Grand Cherokee","Grand Cherokee L","Liberty","Patriot","Renegade","Wrangler"],
  "Kia": ["Cadenza","Carnival","Forte","K5","Niro","Optima","Rio","Sedona","Sorento","Soul","Sportage","Stinger","Telluride"],
  "Land Rover": ["Defender","Discovery","Discovery Sport","Freelander","Range Rover","Range Rover Evoque","Range Rover Sport","Range Rover Velar"],
  "Lexus": ["ES","GS","GX","IS","LC","LS","LX","NX","RX","UX"],
  "Lincoln": ["Aviator","Continental","Corsair","MKC","MKS","MKT","MKX","MKZ","Nautilus","Navigator"],
  "Mazda": ["CX-3","CX-30","CX-5","CX-50","CX-9","Mazda3","Mazda6","MX-5 Miata"],
  "Mercedes-Benz": ["A-Class","C-Class","CLA","CLS","E-Class","G-Class","GLA","GLB","GLC","GLE","GLS","S-Class","SL","SLC","AMG GT"],
  "Mitsubishi": ["Eclipse Cross","Galant","Lancer","Mirage","Outlander","Outlander Sport"],
  "Nissan": ["Altima","Armada","Frontier","Kicks","Leaf","Maxima","Murano","NV","Pathfinder","Rogue","Rogue Sport","Sentra","Titan","Versa","Xterra"],
  "Porsche": ["718 Boxster","718 Cayman","911","Cayenne","Macan","Panamera","Taycan"],
  "Ram": ["1500","1500 Classic","2500","3500","ProMaster","ProMaster City"],
  "Subaru": ["Ascent","BRZ","Crosstrek","Forester","Impreza","Legacy","Outback","WRX"],
  "Tesla": ["Cybertruck","Model 3","Model S","Model X","Model Y"],
  "Toyota": ["4Runner","Avalon","Camry","Corolla","GR86","Highlander","Land Cruiser","Matrix","Prius","RAV4","Sequoia","Sienna","Supra","Tacoma","Tundra","Venza","Yaris"],
  "Volkswagen": ["Atlas","Beetle","Golf","GTI","ID.4","Jetta","Passat","Tiguan","Touareg"],
  "Volvo": ["S60","S90","V60","V90","XC40","XC60","XC90"]
};

const TRIMS = {
  "default": ["Base","S","SE","SEL","Premium","Limited","Sport","Luxury","Platinum","XL","XLT","Lariat","King Ranch","Platinum","High Country","LT","LTZ","LS","SL","SV","SR","SR5","TRD","EX","EX-L","Touring","Signature","Black","Titanium","ST","ST-Line"],
};

const TEMPLATES = [
  { name: "Classic Pro", id: 1 },
  { name: "Short & Bold", id: 2 },
  { name: "Casual Friendly", id: 3 },
  { name: "Emoji Heavy", id: 4 },
  { name: "Luxury Feel", id: 5 },
  { name: "Budget Focus", id: 6 },
  { name: "Truck/SUV Style", id: 7 },
  { name: "Minimal Clean", id: 8 },
  { name: "Spanish Mix", id: 9 },
  { name: "Custom (Edit Below)", id: 10 },
];

const TEMPLATE_CONTENT = {
  1: "{{year}} {{make}} {{model}} {{trim}} \u2014 {{color}}\n\nYear: {{year}}\nMake: {{make}}\nModel: {{model}} {{trim}}\nMiles: {{miles}}\nColor: {{color}}\nEngine: {{engine}}\nDrivetrain: {{drivetrain}}\nTransmission: {{transmission}}\n\n\u2705 Key Features:\n{{features}}\n\n\uD83D\uDCB0 Priced to Sell @ ${{price}} Cash + Tax & Doc Fee\n\nWe also have financing available for all credit types!\n\nDon't hesitate to reach out \u2014 happy to answer any questions!\n\uD83D\uDCCD {{address}}\n\uD83D\uDD50 {{hours}}\n\uD83C\uDF10 {{website}}",

  2: "\uD83D\uDE98 {{year}} {{make}} {{model}} {{trim}} | {{miles}} Miles | ${{price}}\n\n{{engine}} | {{drivetrain}} | {{color}}\n\nTOP FEATURES:\n{{features}}\n\nFinancing available for all credit types.\n\uD83D\uDCCD {{address}} | {{hours}} | {{website}}",

  3: "Hey there! Check out this awesome {{year}} {{make}} {{model}} {{trim}}!\n\nShe's got {{miles}} miles, rocking that {{color}} exterior, and she drives smooth as butter. Here's what she's packing:\n\n{{features}}\n\nWe've got it priced right at ${{price}} + Tax & Doc. We also work with all types of credit, so don't let that hold you back!\n\nGive us a call or shoot us a message \u2014 we love answering questions!\n\uD83D\uDCCD {{address}}\n\u23F0 {{hours}}\n\uD83C\uDF10 {{website}}",

  4: "\uD83D\uDD25\uD83D\uDD25 {{year}} {{make}} {{model}} {{trim}} \uD83D\uDD25\uD83D\uDD25\n\n\uD83D\uDCC5 Year: {{year}}\n\uD83C\uDFED Make: {{make}}\n\uD83D\uDE97 Model: {{model}} {{trim}}\n\uD83D\uDEE3\uFE0F Miles: {{miles}}\n\uD83C\uDFA8 Color: {{color}}\n\u2699\uFE0F Engine: {{engine}}\n\uD83D\uDD27 Drivetrain: {{drivetrain}}\n\uD83D\uDD04 Transmission: {{transmission}}\n\n\uD83D\uDC8E Features:\n{{features}}\n\n\uD83D\uDCB5 PRICE: ${{price}} Cash + Tax & Doc Fee\n\uD83D\uDCB3 Financing Available for ALL Credit Types!\n\n\uD83D\uDCCD {{address}}\n\uD83D\uDD50 {{hours}}\n\uD83C\uDF10 {{website}}",

  5: "\u2014 {{year}} {{make}} {{model}} {{trim}} \u2014\nPresented by {{address}}\n\nA refined {{color}} {{year}} {{make}} {{model}} with just {{miles}} miles. Powered by a {{engine}} mated to a {{transmission}}, this vehicle exemplifies what {{make}} does best.\n\nDISTINGUISHED FEATURES:\n{{features}}\n\nInvestment: ${{price}} (financing available for qualified buyers)\n\nFor a private showing or inquiries:\n\uD83D\uDCCD {{address}}\n\uD83D\uDD50 {{hours}} | \uD83C\uDF10 {{website}}",

  6: "\u2705 GREAT DEAL ALERT \u2014 {{year}} {{make}} {{model}} {{trim}}\n\nOnly {{miles}} Miles! | {{color}} | ${{price}}\n\nNo need to overpay! This {{engine}} {{drivetrain}} is priced to move.\n\nWhat you get:\n{{features}}\n\n\uD83D\uDCB2 ${{price}} Cash + Tax & Doc\n\uD83D\uDCB3 ALL credit types welcome \u2014 we work with your budget!\n\n\uD83D\uDCCD {{address}} | {{hours}}\n\uD83C\uDF10 {{website}}",

  7: "\uD83D\uDE9B {{year}} {{make}} {{model}} {{trim}} \u2014 READY TO WORK & PLAY \uD83D\uDE9B\n\nSpecs:\n\u25AA Miles: {{miles}}\n\u25AA Color: {{color}}\n\u25AA Engine: {{engine}}\n\u25AA Drivetrain: {{drivetrain}}\n\u25AA Transmission: {{transmission}}\n\nThis beast is loaded:\n{{features}}\n\n\uD83D\uDCB0 Asking ${{price}} + Tax & Doc | Financing Available\n\n\uD83D\uDCCD {{address}}\n\u23F0 {{hours}} | \uD83C\uDF10 {{website}}",

  8: "{{year}} {{make}} {{model}} {{trim}}\n{{miles}} mi \u00B7 {{color}} \u00B7 ${{price}}\n\n{{engine}} \u00B7 {{drivetrain}} \u00B7 {{transmission}}\n\nFeatures:\n{{features}}\n\nFinancing available \u00B7 Tax & doc extra\n{{address}} \u00B7 {{hours}} \u00B7 {{website}}",

  9: "\uD83D\uDE97 {{year}} {{make}} {{model}} {{trim}} \u2014 {{miles}} Millas \u2014 {{color}}\n\n\u2699\uFE0F Motor: {{engine}} | Tracci\u00F3n: {{drivetrain}} | Transmisi\u00F3n: {{transmission}}\n\n\u2705 Caracter\u00EDsticas / Features:\n{{features}}\n\n\uD83D\uDCB0 Precio / Price: ${{price}} + Tax & Doc\n\uD83D\uDCB3 Financiamiento disponible para todos los cr\u00E9ditos / Financing available for all credit types!\n\n\uD83D\uDCCD {{address}}\n\uD83D\uDD50 {{hours}} | \uD83C\uDF10 {{website}}",

  10: "",
};

let selectedFeatures = [];
let currentTemplate = 1;
let vehicleInfo = { engine: '', drivetrain: '', transmission: '' };

// ============================================================
// INIT
// ============================================================
// ============================================================
// VIN DECODER ‚Äî NHTSA Free API
// ============================================================
async function decodeVIN() {
  const vin = document.getElementById('vinInput').value.trim().toUpperCase();
  const statusEl = document.getElementById('vinStatus');

  if (vin.length !== 17) {
    statusEl.style.color = 'var(--red)';
    statusEl.textContent = '‚ö†Ô∏è VIN must be exactly 17 characters.';
    return;
  }

  statusEl.style.color = 'var(--amber)';
  statusEl.textContent = 'üîÑ Looking up VIN...';

  // Try NHTSA first, fall back to Claude AI
  let year = '', make = '', model = '';
  let source = '';

  try {
    const res = await fetch('https://vpic.nhtsa.dot.gov/api/vehicles/decodevinvalues/' + vin + '?format=json');
    if (!res.ok) throw new Error('HTTP ' + res.status);
    const data = await res.json();
    const r = data.Results[0];
    year  = r.ModelYear || '';
    make  = r.Make ? r.Make.charAt(0).toUpperCase() + r.Make.slice(1).toLowerCase() : '';
    model = r.Model || '';
    source = 'NHTSA';
  } catch(e) {
    // NHTSA failed ‚Äî fall back to Claude AI
    statusEl.style.color = 'var(--amber)';
    statusEl.textContent = 'ü§ñ Using AI to decode VIN...';
    try {
      const resp = await fetch("https://api.anthropic.com/v1/messages", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          model: "claude-sonnet-4-20250514",
          max_tokens: 100,
          messages: [{
            role: "user",
            content: `Decode this VIN and respond with ONLY this format, no other text:
YEAR: [4-digit year]
MAKE: [manufacturer name, title case]
MODEL: [model name]

VIN: ${vin}`
          }]
        })
      });
      const data = await resp.json();
      const text = data.content?.[0]?.text || '';
      const yearM = text.match(/YEAR:\s*(\d{4})/i);
      const makeM = text.match(/MAKE:\s*(.+)/i);
      const modelM = text.match(/MODEL:\s*(.+)/i);
      year  = yearM  ? yearM[1].trim()  : '';
      make  = makeM  ? makeM[1].trim()  : '';
      model = modelM ? modelM[1].trim() : '';
      source = 'AI';
    } catch(e2) {
      statusEl.style.color = 'var(--red)';
      statusEl.textContent = '‚ùå Could not decode VIN. Please fill in vehicle details manually.';
      return;
    }
  }

  if (!year || !make || !model) {
    statusEl.style.color = 'var(--red)';
    statusEl.textContent = '‚ùå VIN not recognized. Please fill in vehicle details manually.';
    return;
  }

  // Set Year
  const yearSel = document.getElementById('yearSelect');
  for (let opt of yearSel.options) {
    if (opt.value === year) { yearSel.value = year; break; }
  }

  // Set Make ‚Äî find closest match
  const makeSel = document.getElementById('makeSelect');
  const makeUpper = make.toUpperCase();
  let matched = false;
  for (let opt of makeSel.options) {
    if (opt.value.toUpperCase() === makeUpper) {
      makeSel.value = opt.value;
      matched = true;
      break;
    }
  }

  // Populate models then set model
  populateModels();

  if (matched) {
    const modelSel = document.getElementById('modelSelect');
    const modelUpper = model.toUpperCase();
    let modelMatched = false;
    for (let opt of modelSel.options) {
      if (opt.value.toUpperCase() === modelUpper) {
        modelSel.value = opt.value;
        modelMatched = true;
        break;
      }
    }
    if (!modelMatched) {
      for (let opt of modelSel.options) {
        if (opt.value.toUpperCase().includes(modelUpper) || modelUpper.includes(opt.value.toUpperCase())) {
          modelSel.value = opt.value;
          modelMatched = true;
          break;
        }
      }
    }
    if (modelMatched) populateTrims();
  }

  updateFetchBtn();

  statusEl.style.color = 'var(--green)';
  const tag = source === 'AI' ? ' (via AI)' : '';
  statusEl.textContent = `‚úÖ ${year} ${make} ${model} ‚Äî dropdowns filled!${tag}`;
}

// Allow pressing Enter in VIN field
document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('vinInput').addEventListener('keydown', e => {
    if (e.key === 'Enter') decodeVIN();
  });
});

function init() {
  // Years
  const yearSel = document.getElementById('yearSelect');
  const currentYear = new Date().getFullYear();
  for (let y = currentYear + 1; y >= 2010; y--) {
    yearSel.innerHTML += `<option value="${y}">${y}</option>`;
  }

  // Makes ‚Äî populate and enable immediately
  const makeSel = document.getElementById('makeSelect');
  makeSel.disabled = false;
  Object.keys(MAKES_MODELS).sort().forEach(m => {
    const opt = document.createElement('option');
    opt.value = m;
    opt.textContent = m;
    makeSel.appendChild(opt);
  });

  // Template buttons
  const tg = document.getElementById('templateGrid');
  TEMPLATES.forEach(t => {
    const btn = document.createElement('button');
    btn.className = 'template-btn' + (t.id === 1 ? ' active' : '');
    btn.textContent = t.name;
    btn.onclick = () => selectTemplate(t.id, btn);
    tg.appendChild(btn);
  });

  yearSel.addEventListener('change', updateFetchBtn);
  makeSel.addEventListener('change', () => { populateModels(); updateFetchBtn(); });
  document.getElementById('modelSelect').addEventListener('change', () => { populateTrims(); updateFetchBtn(); });
  document.getElementById('trimSelect').addEventListener('change', updateFetchBtn);
}

function populateModels() {
  const make = document.getElementById('makeSelect').value;
  const modelSel = document.getElementById('modelSelect');
  const trimSel = document.getElementById('trimSelect');

  // Reset model
  modelSel.innerHTML = '<option value="">Select Model</option>';
  trimSel.innerHTML = '<option value="">Select Trim</option>';
  trimSel.disabled = true;

  if (make && MAKES_MODELS[make]) {
    MAKES_MODELS[make].forEach(m => {
      const opt = document.createElement('option');
      opt.value = m;
      opt.textContent = m;
      modelSel.appendChild(opt);
    });
    modelSel.disabled = false;
  } else {
    modelSel.disabled = true;
  }
}

function populateTrims() {
  const make = document.getElementById('makeSelect').value;
  const model = document.getElementById('modelSelect').value;
  const trimSel = document.getElementById('trimSelect');
  trimSel.innerHTML = '<option value="">Select Trim</option>';

  if (model) {
    const trims = TRIMS[make + '_' + model] || TRIMS['default'];
    trims.forEach(t => {
      const opt = document.createElement('option');
      opt.value = t;
      opt.textContent = t;
      trimSel.appendChild(opt);
    });
    trimSel.disabled = false;
  } else {
    trimSel.disabled = true;
  }
}

function updateFetchBtn() {
  const y = document.getElementById('yearSelect').value;
  const ma = document.getElementById('makeSelect').value;
  const mo = document.getElementById('modelSelect').value;
  document.getElementById('fetchBtn').disabled = !(y && ma && mo);
}

function selectTemplate(id, btn) {
  document.querySelectorAll('.template-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  currentTemplate = id;
}

// ============================================================
// FETCH FEATURES via Claude API
// ============================================================
async function fetchFeatures() {
  const year = document.getElementById('yearSelect').value;
  const make = document.getElementById('makeSelect').value;
  const model = document.getElementById('modelSelect').value;
  const trim = document.getElementById('trimSelect').value || '';

  if (!year || !make || !model) return;

  document.getElementById('featuresContainer').style.display = 'block';
  setStatus('loading', `Searching features for ${year} ${make} ${model} ${trim}...`);
  document.getElementById('featuresList').innerHTML = '';
  selectedFeatures = [];

  const prompt = `You are an automotive database expert. For the ${year} ${make} ${model} ${trim ? trim + ' trim' : ''}, provide:

1. ENGINE: (e.g. "3.5L V6")
2. DRIVETRAIN: (e.g. "AWD" or "FWD" or "RWD" or "4WD")
3. TRANSMISSION: (e.g. "8-Speed Automatic")
4. KEY_FEATURES: A list of the notable standard and available features for this specific trim, each on its own line. Include things like: seating type/material, infotainment screen size, safety tech, driver assists, sunroof/moonroof, remote start, navigation, Bluetooth, camera systems, heated/ventilated seats, heated steering wheel, 3rd row seating if applicable, towing capacity if notable, etc. Add a relevant emoji at the end of each feature (like üî• for heated, ‚ùÑÔ∏è for cooling, üéµ for audio, üì± for connectivity, etc.)

Format your response EXACTLY like this (no extra text):
ENGINE: [value]
DRIVETRAIN: [value]
TRANSMISSION: [value]
KEY_FEATURES:
[feature 1 with emoji]
[feature 2 with emoji]
[feature 3 with emoji]
...

Include 10-18 features. Be specific to this exact vehicle trim.`;

  try {
    const resp = await fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model: "claude-sonnet-4-20250514",
        max_tokens: 1000,
        messages: [{ role: "user", content: prompt }]
      })
    });
    const data = await resp.json();
    const text = data.content?.[0]?.text || '';
    parseVehicleData(text);
    setStatus('done', 'Features loaded! Check/uncheck what applies.');
  } catch (e) {
    setStatus('error', 'Error fetching features. Check connection.');
  }
}

function parseVehicleData(text) {
  const engineMatch = text.match(/ENGINE:\s*(.+)/i);
  const driveMatch = text.match(/DRIVETRAIN:\s*(.+)/i);
  const transMatch = text.match(/TRANSMISSION:\s*(.+)/i);
  vehicleInfo.engine = engineMatch ? engineMatch[1].trim() : '';
  vehicleInfo.drivetrain = driveMatch ? driveMatch[1].trim() : '';
  vehicleInfo.transmission = transMatch ? transMatch[1].trim() : '';

  const featSection = text.split(/KEY_FEATURES:/i)[1] || '';
  const lines = featSection.split('\n').map(l => l.trim()).filter(l => l.length > 2);

  selectedFeatures = [];
  const list = document.getElementById('featuresList');
  list.innerHTML = '';

  // Always add "Runs & Drives Great" first
  addFeatureItem('Runs & Drives Great üöóüí®‚úÖ', true, list);

  lines.forEach(line => {
    if (line && !line.startsWith('ENGINE') && !line.startsWith('DRIVETRAIN') && !line.startsWith('TRANSMISSION')) {
      addFeatureItem(line, true, list);
    }
  });
}

function addFeatureItem(text, active, container) {
  const div = document.createElement('div');
  div.className = 'feature-item' + (active ? '' : ' inactive');

  const span = document.createElement('span');
  span.textContent = text;
  div.appendChild(span);
  container.appendChild(div);

  if (active) selectedFeatures.push(text);

  div.addEventListener('click', function() {
    const isActive = !div.classList.contains('inactive');
    if (isActive) {
      div.classList.add('inactive');
      selectedFeatures = selectedFeatures.filter(f => f !== text);
    } else {
      div.classList.remove('inactive');
      if (!selectedFeatures.includes(text)) selectedFeatures.push(text);
    }
  });
}

function addCustomFeature() {
  const inp = document.getElementById('customFeatureInput');
  const val = inp.value.trim();
  if (!val) return;
  const list = document.getElementById('featuresList');
  if (list.children.length === 0) document.getElementById('featuresContainer').style.display = 'block';
  addFeatureItem(val, true, list);
  inp.value = '';
}

function setStatus(type, msg) {
  const s = document.getElementById('statusMsg');
  const dotClass = type === 'loading' ? 'pulse' : type === 'done' ? 'green' : 'red';
  s.className = `status ${type}`;
  s.innerHTML = `<div class="dot ${dotClass}"></div>${msg}`;
}

// ============================================================
// GENERATE LISTING
// ============================================================
function generateListing() {
  const year = document.getElementById('yearSelect').value || '____';
  const make = document.getElementById('makeSelect').value || '____';
  const model = document.getElementById('modelSelect').value || '____';
  const trim = document.getElementById('trimSelect').value || '';
  const miles = document.getElementById('milesInput').value || '____';
  const color = document.getElementById('colorInput').value || '____';
  const price = document.getElementById('priceInput').value || '____';
  const address = document.getElementById('dealerAddress').value || 'Your Address Here';
  const hours = document.getElementById('dealerHours').value || 'Mon‚ÄìSat 10am‚Äì6pm';
  const website = document.getElementById('dealerWebsite').value || 'YourWebsite.com';

  const featuresText = getCheckedFeatures().map(f => f).join('\n');

  let template = currentTemplate === 10
    ? document.getElementById('customTemplate').value
    : TEMPLATE_CONTENT[currentTemplate];

  const output = template
    .replace(/{{year}}/g, year)
    .replace(/{{make}}/g, make)
    .replace(/{{model}}/g, model)
    .replace(/{{trim}}/g, trim)
    .replace(/{{miles}}/g, miles)
    .replace(/{{color}}/g, color)
    .replace(/{{price}}/g, price)
    .replace(/{{engine}}/g, vehicleInfo.engine || '____')
    .replace(/{{drivetrain}}/g, vehicleInfo.drivetrain || '____')
    .replace(/{{transmission}}/g, vehicleInfo.transmission || '____')
    .replace(/{{features}}/g, featuresText || '(No features selected)')
    .replace(/{{address}}/g, address)
    .replace(/{{hours}}/g, hours)
    .replace(/{{website}}/g, website);

  document.getElementById('outputText').value = output;
}

function getCheckedFeatures() {
  const items = document.querySelectorAll('#featuresList .feature-item:not(.inactive)');
  return Array.from(items).map(item => item.querySelector('span').textContent);
}

function copyListing() {
  const ta = document.getElementById('outputText');
  ta.select();
  document.execCommand('copy');
  const btn = document.querySelector('.btn-success');
  btn.textContent = '‚úÖ Copied!';
  setTimeout(() => btn.textContent = 'üìã Copy', 2000);
}

function clearAll() {
  document.getElementById('outputText').value = '';
  document.getElementById('featuresList').innerHTML = '';
  document.getElementById('featuresContainer').style.display = 'none';
  selectedFeatures = [];
  vehicleInfo = { engine: '', drivetrain: '', transmission: '' };
}

function saveCustomTemplate() {
  TEMPLATE_CONTENT[10] = document.getElementById('customTemplate').value;
  alert('Saved as Preset 10!');
}

function useCustomTemplate() {
  const btns = document.querySelectorAll('.template-btn');
  btns.forEach((b,i) => b.classList.toggle('active', i === 9));
  currentTemplate = 10;
}

init();
</script>

<script>
function switchTab(tab) {
  const inputPanel = document.getElementById('inputPanel');
  const outputPanel = document.getElementById('outputPanel');
  const tabInput = document.getElementById('tabInput');
  const tabOutput = document.getElementById('tabOutput');
  if (tab === 'input') {
    inputPanel.classList.add('mob-active');
    outputPanel.classList.remove('mob-active');
    tabInput.classList.add('active');
    tabOutput.classList.remove('active');
  } else {
    outputPanel.classList.add('mob-active');
    inputPanel.classList.remove('mob-active');
    tabOutput.classList.add('active');
    tabInput.classList.remove('active');
    // scroll to top of output
    outputPanel.scrollTop = 0;
    window.scrollTo(0,0);
  }
}

// Auto-switch to output tab after generating on mobile
const _origGenerate = generateListing;
generateListing = function() {
  _origGenerate();
  if (window.innerWidth <= 768) switchTab('output');
};
</script>
</body>
</html>
